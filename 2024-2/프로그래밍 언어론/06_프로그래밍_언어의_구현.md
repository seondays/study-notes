# 06. 프로그래밍 언어의 구현
## 프로그래밍 언어 구현
프로그래밍 언어로 작성된 프로그램이 주어졌을 때, 해당 프로그램이 언어의 구문 규칙을 따르는 올바른 프로그램인지 검사하고, 올바른 경우에 프로그램을 해당 언어의 의미 규칙에 따라 실행하는 프로그램이 언어의 구현이다.
## 프로그래밍 언어 구현 방법
### 개요
전통적인 언어 구현 vs 새로운 패러다임 언어 구현
- 전통적 → 기계어나 어셈블리어를 확장하는 형태로 구현
	- 순차적 제어 흐름을 유지하고, 제공하고 있는 명령어 집합을 늘리는 형태
	- 절차형 : 함수, 프로시저, 사용자 정의 연산자와 명령어 지원하는 형태로 구현
	- 객체지향 : 자료형에 함수, 프로시저를 연관시켜 사용자 정의 자료형 지원 형태로 구현
		- 데이터 상속 기능 제공 → IS-A 관계
- 새로운 패러다임 → 생소한 계산 모델의 사용으로 단순히 저급언어를 확장하는 식으로 구현하기 어려움
	- 람다 계산, 연역 논리 등
	- 언어의 복잡한 계산 모델과 현재 하드웨어 사이에 하나의 중간 기계를 놓는 아이디어 → 추상기계/가상기계
### 컴파일러 구현 단계
크게 분석단계와 생성단계로 나누어진다
#### 분석 단계 (전단부)
어휘 분석 → 구문 분석 → 의미 분석
- 주어진 프로그램을 구성 요소로 나눠 구조 파악
- 즉 구현할 프로그래밍 언어에 종속적
- 구문 분석 단계 이후 트리 형태로 변경됨 → 구문 트리
- 의미 분석 단계에서 해당 트리가 올바른 형태인지 파악 (정적 의미론 사용)
#### 생성 단계 (후단부)
분석 단계를 마치면 컴파일러가 다룰 수 있을 정도의 정형화된 트리가 만들어지고(중간 코드), 컴파일러는 이를 최종적으로 목적 코드 형태로 변경한다.

중간 코드 최적화 → 코드 생성 → 목적 코드 최적화
- 목적 기계에 적합한 형태의 명령어로 변환
- 생성될 목적 코드의 수행 성능 향상 (중점적 기능)
### 인터프리터 구현 단계
컴파일러 구현과 분석 단계는 동일하지만, 중간 표현에서 코드를 만드는 것이 아니라 이를 해석하여 바로 실행한다.

어휘 분석 → 구문 분석 → 의미 분석 → 중간 표현 → 인터프리터 엔진을 거쳐 바로 실행
- 따라서 해석 단위의 규정이 필요

만약 중간 표현이 중간 코드 형태이고, 이후 해석 단계가 가상기계 형태인 경우 이 때의 중간 코드를 바이트코드라고 부르기도 한다.
- 이런 경우의 분석 단계는 원시 프로그램을 중간 코드로 변경 → 즉 이 부분이 일종의 컴파일러 역할로 하이브리드 구현이 된다.
### 언어 구현에 필요한 자료 구조
- 구문 트리 : 원시코드로부터 분석 단계를 거쳐 구문 트리 생성, 구문 트리로부터 목적 코드 생성
- 심볼 테이블 : 컴파일러 구현에 사용되며 프로그램에서 정의하거나 선언한 식별자 정보를 저장하고 있는 표
	- 구문 분석 뿐 아니라 의미 분석 단계에서도 활용된다 (C 컴파일러가 디버깅 정보 생성을 위해 심볼 테이블의 일부 정보 저장)
- 환경 : 인터프리터의 경우 식별자의 값을 이용하여 올바른 값으로 해석해야 하기 때문에 심볼 테이블보다 더 확장된 테이블이 필요하다. 이를 환경이라고 함. 즉 식별자 정보와 함께 값 정보까지 포함
- 실행 환경 : 컴파일러가 실행 시 필요로 하는 환경.
	- 실행을 지원하기 위한 메모리 구조와 이를 관리하기 위한 레지스터 포함(PC, SP 등등)
- 정적 세그먼트 : 메모리 구역 중 코드와 정적 데이터 구획을 묶어서 지칭. 정적 데이터는 주소가 미리 결정되어 있는 변수 공간으로 이루어짐
- 동적 세그먼트 : 메모리 구역 중 스택과 힙을 하나로 묶어 지칭. 스택은 서브프로그램의 활성 레코드 관리, 힙은 수동 할당 변수 공간으로 사용
### 언어 구현 실제
#### 어휘 분석기 구현
프로그램의 어휘를 구별해 내고, 필요에 따라서 속성을 구해 구문 분석기에 전달하는 기능
- 유한 상태 기계 구성 → 어휘 분석기에 사용되는 유한 상태 기계를 유한 오토마타라고 부름
#### 구문 분석기 구현
어휘 분석기가 만들어낸 토큰 열로부터 트리를 구성하여 구문 트리를 만든다.
- 파스 트리 / 압축된 형태의 트리인 추상 구문 트리
	- 실제로는 구문 트리의 크기가 훨씬 작은 추상 구문 트리가 사용된다.
- 구문 트리 자체를 생성하는 프로그램보다 구문 트리를 순회하는 여러 프로시저로 구성된 프로그램을 구문 분석기라고 부르기도 한다 → 순환 하강 구문 분석기(문법 규칙을 그대로 코드로 바꾼 형태)